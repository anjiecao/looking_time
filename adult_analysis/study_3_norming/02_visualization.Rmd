---
title: "02_visualization"
output: html_document
date: "`r Sys.Date()`"
---


```{r}
library(tidyverse)
library(here)
library(jsonlite)
library(ggthemes)

cr <- read_csv(here("data/complexity_rating.csv")) %>% mutate(complexity_rating = complexity_rating + 1)
sr <- read_csv(here("data/similarity_rating.csv"))
em <- read_csv(here("data/adult_norming_embeddings.csv"))

```

```{r}
cr %>% distinct(subject) %>% count()
sr %>% distinct(subject) %>% count()

```



# Complexity rating 

```{r}
cr %>% 
  ggplot(aes(x = rating_animacy, y = complexity_rating)) + 
  stat_summary(fun.data = "mean_cl_boot", position = position_dodge(width = .2)) + 
  ylim(0, 7) + 
  theme_few() 


cr %>% 
  ggplot(aes(x = rating_pose, y = complexity_rating)) + 
  stat_summary(fun.data = "mean_cl_boot", position = position_dodge(width = .2)) + 
    ylim(0, 7) + 
  theme_few() 


cr %>% 
  ggplot(aes(x = rating_number, y = complexity_rating)) + 
  stat_summary(fun.data = "mean_cl_boot", position = position_dodge(width = .2)) + 
  ylim(0, 7) + 
  theme_few() 


```

```{r}
cr %>% 
  ggplot(aes(x = rating_animacy, y = complexity_rating, color = rating_number)) + 
  stat_summary(fun.data = "mean_cl_boot", position = position_dodge(width = .2)) + 
  ylim(0, 7) + 
  theme_few()  + 
  facet_wrap(~rating_pose)

```



```{r}
cr %>% 
   ggplot(aes(x = rating_stimulus, y = complexity_rating)) + 
  stat_summary(fun.data = "mean_cl_boot", position = position_dodge(width = .2)) + 
  theme_few() + 
   theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) 
```


```{r}
cr %>% 
  mutate(stim_name = gsub("media/stimuli/","",  rating_stimulus)) %>% 
  mutate(stim_name = gsub("inanimate", "veggie", stim_name)) %>% 
  distinct(stim_name) %>% 
  arrange(stim_name)
  #left_join(em, by = "stim_name")
```

animate_003_left.png	 - animate_003_left.png	



```{r}
em %>% 
  arrange(stim_name)
```



# Similarity 

```{r}
sr %>% 
  group_by(subject) %>% 
  count() %>% 
  rename(n_trial = n) %>% 
  left_join(sr, by = "subject") %>% 
  group_by(subject, n_trial, chosen_violation) %>% 
  count() %>% 
  filter(!is.na(chosen_violation)) %>%
  mutate(proportion = n / n_trial) %>% 
  ggplot(aes(x = chosen_violation, y = proportion)) + 
  stat_summary(fun.data = "mean_cl_boot", position = position_dodge(width = .2)) + 
  theme_few() 
```


