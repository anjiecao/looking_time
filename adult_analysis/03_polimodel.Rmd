---
title: "03_polimodel"
author: "anjie"
date: "2/22/2021"
output: html_document
---

```{r}
library(tidyverse)
library(patchwork)
library(here)

source(here("scripts/poli_model_wave2.R"))

```

reproducing poli: https://rpubs.com/anjiecao/729261

# single block using example sequence
```{r}
example_seq <- c(1,1,1,1,2,1)
single_block_dissimilar <- poli_model_pokebaby(example_seq, similar = FALSE) %>% 
  mutate(similarity = "dissimilar")

```



```{r}

single_block_similar <- poli_model_pokebaby(example_seq, similar = TRUE) %>% 
  mutate(similarity = "similar") 

single_block_similarity <- bind_rows(single_block_similar, single_block_dissimilar)


```


```{r}
 df.plot <- single_block_similarity %>% 
    select(trials, surprisal, predictability, learning_progress, similarity) %>% 
    pivot_longer(cols = c("surprisal", "predictability", "learning_progress"), 
                 names_to = "measure", 
                 values_to = "value") %>% 
    filter(trials != 0)
  
  surprise_plot <- df.plot %>% 
    filter(measure == "surprisal") %>% 
    ggplot(aes(x = trials, y = value, color = similarity)) + 
    geom_point(position = position_dodge(width = .1)) + 
    geom_line() + 
    ylab("surprise") #+ 
  #scale_x_continuous(breaks =seq(1,12,1))
  
  predictability_plot <- df.plot %>% 
    filter(measure == "predictability") %>% 
    ggplot(aes(x = trials, y = value, color = similarity)) + 
    geom_point(position = position_dodge(width = .1)) + 
    geom_line() + 
    ylab("predictability") #+ 
  #scale_x_continuous(breaks =seq(1,12,1))
  
  learning_progress_plot <- df.plot %>% 
    filter(measure == "learning_progress") %>% 
    ggplot(aes(x = trials, y = value, color = similarity)) + 
    geom_point(position = position_dodge(width = .1)) + 
    geom_line() + 
    ylab("learning_progress") #+ 
  #scale_x_continuous(breaks =seq(1,12,1))
  
  surprise_plot+predictability_plot+learning_progress_plot + plot_layout(ncol = 1)
```


