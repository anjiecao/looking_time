get.vars(kl_c_a5b1)
myfunc <- function(v1) {
deparse(substitute(v1))
}
myfunc(kl_c_a5b1)
kl_s_a1b1 <- kl_s_a1b1 %>%
mutate(params = deparse(substitute(kl_s_a1b1)))
kl_s_a1b1
kl_s_a1b1$params
kl_s_a1b1 <- readRDS(here("adult_modeling/m_res/obs_1_sequential_update_kl.rds")) %>%
mutate(complexity = "simple",
params = "a1b1")
kl_s_a1b1 <- readRDS(here("adult_modeling/m_res/obs_1_sequential_update_kl.rds")) %>%
mutate(complexity = "simple",
params = "a1b1")
kl_c_a1b1 <- readRDS(here("adult_modeling/m_res/obs_2_sequential_update_kl.rds")) %>%
mutate(complexity = "complex",
params = "a1b1")
kl_s_a1b5 <- readRDS(here("adult_modeling/m_res/obs_1_a1b5_sequential_update_kl.rds")) %>%
mutate(complexity = "simple",
params = "a1b5")
kl_c_a1b5 <- readRDS(here("adult_modeling/m_res/obs_2_a1b5_sequential_update_kl.rds")) %>%
mutate(complexity = "complex",
params = "a1b5")
kl_s_a5b1 <- readRDS(here("adult_modeling/m_res/obs_1_a5b1_sequential_update_kl.rds")) %>%
mutate(complexity = "simple",
params = "a5b1")
kl_c_a5b1 <- readRDS(here("adult_modeling/m_res/obs_2_a5b1_sequential_update_kl.rds")) %>%
mutate(complexity = "complex",
params = "a5b1")
kl_all <- bind_rows(kl_s_a1b1,
kl_c_a1b1,
kl_s_a1b5,
kl_c_a1b5,
kl_s_a5b1,
kl_c_a5b1)
kl_all %>%
group_by(update_number, complexity, params) %>%
summarise(kl_creature = sum(kl)) %>%
ggplot(aes(x = trial_num,
y = kl_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
kl_all %>%
group_by(update_number, complexity, params) %>%
summarise(kl_creature = sum(kl)) %>%
ggplot(aes(x = update_number,
y = kl_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
kl_all %>%
group_by(update_number, complexity, params) %>%
summarise(kl_creature = sum(kl))
kl_all %>%
group_by(update_number, complexity, params)
kl_all %>%
group_by(update_step, complexity, params) %>%
summarise(kl_creature = sum(kl))
kl_all %>%
group_by(update_step, complexity, params) %>%
summarise(kl_creature = sum(kl)) %>%
ggplot(aes(x = update_number,
y = kl_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
kl_all %>%
group_by(update_step, complexity, params) %>%
summarise(kl_creature = sum(kl)) %>%
ggplot(aes(x = update_step,
y = kl_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
kl_all %>%
group_by(update_step, complexity, params) %>%
summarise(kl_creature = sum(kl))
kl_all %>%
filter(complexity == "complex")
View(kl_c_a1b5)
saveRDS(obs_2_sequential_update_kl,
file = here("adult_modeling/obs_2_a1b5_sequential_update_kl.rds"))
kl_c_a1b5 <- readRDS(here("adult_modeling/m_res/obs_2_a1b5_sequential_update_kl.rds")) %>%
mutate(complexity = "complex",
params = "a1b5")
View(kl_c_a1b5)
View(kl_c_a1b1)
View(kl_c_a5b1)
grid_theta <- seq(0.1, 1, 0.2)
grid_epsilon <- seq(0.1, 1, 0.2)
alpha_prior = 1
beta_prior = 1
alpha_epsilon = 1
beta_epsilon = 10
obs_2_sequential_update <- update_posterior_distribution(grid_theta = grid_theta,
grid_epsilon = grid_epsilon,
observations = obs_2,
alpha_prior = alpha_prior,
beta_prior = beta_prior,
alpha_epsilon = 1,
beta_epsilon = 10
)
View(kl_c_a5b1)
obs_2_sequential_update_kl <- get_kl_for_creature(obs_2_sequential_update)
saveRDS(obs_2_sequential_update_kl,
file = here("adult_modeling/obs_2_a1b1_sequential_update_kl.rds"))
saveRDS(obs_2_sequential_update_kl,
file = here("adult_modeling/obs_2_sequential_update_kl.rds"))
kl_c_a1b1 <- readRDS(here("adult_modeling/m_res/obs_2_sequential_update_kl.rds")) %>%
mutate(complexity = "complex",
params = "a1b1")
View(kl_c_a1b1)
View(kl_c_a5b1)
grid_theta <- seq(0.1, 1, 0.2)
grid_epsilon <- seq(0.1, 1, 0.2)
alpha_prior = 5
beta_prior = 1
alpha_epsilon = 1
beta_epsilon = 10
obs_2_sequential_update <- update_posterior_distribution(grid_theta = grid_theta,
grid_epsilon = grid_epsilon,
observations = obs_2,
alpha_prior = alpha_prior,
beta_prior = beta_prior,
alpha_epsilon = 1,
beta_epsilon = 10
)
obs_2_sequential_update_kl <- get_kl_for_creature(obs_2_sequential_update)
saveRDS(obs_2_sequential_update_kl,
file = here("adult_modeling/obs_2_a5b1_update_kl.rds"))
kl_s_a1b1 <- readRDS(here("adult_modeling/m_res/obs_1_sequential_update_kl.rds")) %>%
mutate(complexity = "simple",
params = "a1b1")
kl_c_a1b1 <- readRDS(here("adult_modeling/m_res/obs_2_sequential_update_kl.rds")) %>%
mutate(complexity = "complex",
params = "a1b1")
kl_s_a1b5 <- readRDS(here("adult_modeling/m_res/obs_1_a1b5_sequential_update_kl.rds")) %>%
mutate(complexity = "simple",
params = "a1b5")
kl_c_a1b5 <- readRDS(here("adult_modeling/m_res/obs_2_a1b5_sequential_update_kl.rds")) %>%
mutate(complexity = "complex",
params = "a1b5")
kl_s_a5b1 <- readRDS(here("adult_modeling/m_res/obs_1_a5b1_sequential_update_kl.rds")) %>%
mutate(complexity = "simple",
params = "a5b1")
kl_c_a5b1 <- readRDS(here("adult_modeling/m_res/obs_2_a5b1_sequential_update_kl.rds")) %>%
mutate(complexity = "complex",
params = "a5b1")#needs rerun
kl_all <- bind_rows(kl_s_a1b1,
kl_c_a1b1,
kl_s_a1b5,
kl_c_a1b5,
kl_s_a5b1,
kl_c_a5b1)
kl_all %>%
filter(complexity == "complex")
kl_all %>%
group_by(update_step, complexity, params) %>%
summarise(kl_creature = sum(kl)) %>%
ggplot(aes(x = update_step,
y = kl_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
s_a1b1_e <- get_entropy_for_creature_udpates(s_a1b1)
c_a1b1_e <- get_entropy_for_creature_udpates(c_a1b1) %>%
mutate(complexity = "complex",
params = "c_a1b1")
s_a1b5_e <- get_entropy_for_creature_udpates(s_a1b5) %>%
mutate(complexity = "simple",
params = "s_a1b5")
c_a1b5_e <- get_entropy_for_creature_udpates(c_a1b5)%>%
mutate(complexity = "complex",
params = "c_a1b5")
s_a5b1_e <- get_entropy_for_creature_udpates(s_a5b1)%>%
mutate(complexity = "simple",
params = "s_a5b1")
c_a5b1_e <- get_entropy_for_creature_udpates(c_a5b1)%>%
mutate(complexity = "simple",
params = "c_a5b1")
s_a1b1_e <- s_a1b1_e %>%
rename("s_a1b1" = "a1b1")
View(s_a1b1_e)
View(s_a1b1_e)
View(c_a1b1_e)
s_a1b1_e <- get_entropy_for_creature_udpates(s_a1b1) %>%
mutate(complexity = "simple",
params = "s_a1b1")
View(s_a1b5_e)
View(c_a1b1_e)
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e)
View(e_all)
View(e_all)
e_all %>%
group_by(update_step, complexity, params) %>%
summarise(predictability_creature = sum(predictability)) %>%
ggplot(aes(x = update_step,
y = predictability_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
View(e_all)
e_all %>%
group_by(update_number, complexity, params) %>%
summarise(predictability_creature = sum(predictability)) %>%
ggplot(aes(x = update_step,
y = predictability_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
e_all %>%
group_by(update_number, complexity, params) %>%
summarise(predictability_creature = sum(predictability)) %>%
ggplot(aes(x = update_number,
y = predictability_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
e_all %>%
group_by(update_number, complexity, params) %>%
summarise(predictability_creature = sum(predictability))
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e) %>%
mutate(params = case_when(
grepl("a1b1", params) ~ "a1b1",
grepl("a1b5", params) ~ "a1b5",
grepl("a5b1", params) ~ "a5b1"
))
e_all %>%
group_by(update_number, complexity, params) %>%
summarise(predictability_creature = sum(predictability)) %>%
ggplot(aes(x = update_number,
y = predictability_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
View(c_a5b1_e)
e_all %>% filter(params == "a5b1")
e_all %>% filter(params == "a5b1") %>% filter(compplexity == "complex")
e_all %>% filter(params == "a5b1") %>% filter(complexity == "complex")
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e)
e_all
e_all %>% filter(params == "c_a5b1")
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e) %>%
mutate(params = case_when(
grepl("a1b1", params) ~ "a1b1",
grepl("a1b5", params) ~ "a1b5",
grepl("a5b1", params) ~ "a5b1"
))
e_all %>% filter(paras == "a5b1") %>% distinct(params)
e_all %>% filter(params == "a5b1") %>% distinct(params)
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e)
e_all %>%  distinct(params)
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e) %>%
mutate(params = case_when(
grepl("a1b1", params) ~ "a1b1",
grepl("a1b5", params) ~ "a1b5",
grepl("a5b1", params) ~ "a5b1"
))
e_all %>%  distinct(params)
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e) %>%
mutate(
params_short = case_when(
grepl("a1b1", params) ~ "a1b1",
grepl("a1b5", params) ~ "a1b5",
grepl("a5b1", params) ~ "a5b1"
))
e_all %>%  distinct(params_short)
e_all %>% distinct(params)
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e) %>%
separate(params, sep = "c", into = c("short_comp", "params")) %>%
select(-short_comp)
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e) %>%
separate(params, sep = "_", into = c("short_comp", "params")) %>%
select(-short_comp)
e_all %>%
group_by(update_number, complexity, params) %>%
summarise(predictability_creature = sum(predictability)) %>%
ggplot(aes(x = update_number,
y = predictability_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
e_all  %>% distinct(params) %>% count()
e_all  %>% distinct(params)
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e) %>%
separate(params, sep = "_", into = c("short_comp", "new_param")) %>%
select(-short_comp)
e_all %>% distinct(params, new_param)
e_all %>% distinct(new_param)
c_a5b1_e <- get_entropy_for_creature_udpates(c_a5b1)%>%
mutate(complexity = "complex",
params = "a5b1")
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e) %>%
separate(params, sep = "_", into = c("short_comp", "params")) %>%
select(-short_comp)
View(c_a5b1_e)
s_a1b1_e <- get_entropy_for_creature_udpates(s_a1b1) %>%
mutate(complexity = "simple",
params = "a1b1")
c_a1b1_e <- get_entropy_for_creature_udpates(c_a1b1) %>%
mutate(complexity = "complex",
params = "a1b1")
s_a1b5_e <- get_entropy_for_creature_udpates(s_a1b5) %>%
mutate(complexity = "simple",
params = "a1b5")
c_a1b5_e <- get_entropy_for_creature_udpates(c_a1b5)%>%
mutate(complexity = "complex",
params = "a1b5")
s_a5b1_e <- get_entropy_for_creature_udpates(s_a5b1)%>%
mutate(complexity = "simple",
params = "a5b1")
c_a5b1_e <- get_entropy_for_creature_udpates(c_a5b1)%>%
mutate(complexity = "complex",
params = "a5b1")
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e)
e_all %>%
group_by(update_number, complexity, params) %>%
summarise(predictability_creature = sum(predictability)) %>%
ggplot(aes(x = update_number,
y = predictability_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
s_a1b1_s <- get_surprise_for_creature_udpates(s_a1b1) %>%
mutate(complexity = "simple",
params = "a1b1")
source(here("adult_modeling/scripts/get_surprise.R"))
s_a1b1_s <- get_surprise_for_creature_udpates(s_a1b1) %>%
mutate(complexity = "simple",
params = "a1b1")
source('~/Desktop/projects/looking_time/adult_analysis/adult_modeling/scripts/get_surprise.R', echo=TRUE)
s_a1b1_s <- get_surprise_for_creature_udpates(s_a1b1) %>%
mutate(complexity = "simple",
params = "a1b1")
get_surprise_for_feature_updates <- function(feature_i, updates_df){
feature_df <- updates_df %>%
filter(feature_index == feature_i)
thetas <- feature_df %>%
distinct(theta) %>%
pull()
all_updates <- feature_df %>%
distinct(update_number) %>%
pull()
# FIXME: currently not including the prior's surprise(?)
all_surprise <- c()
for (i in all_updates){
current_lps <- feature_df %>%
filter(update_number == i) %>%
pull(log_posterior)
current_s <-weighted.mean(x = -current_lps, w = exp(current_lps))
all_surprise <- c(all_surprise, current_s)
}
surprise_df <- tibble(surprise = all_surprise,
update_number = seq(1, length(all_surprise), 1)) %>%
mutate(feature_index = feature_i)
return(surprise_df)
}
get_surprise_for_creature_updates <- function(updates_df){
all_features <- updates_df %>%
distinct(feature_index) %>%
pull()
lapply(all_features, function(x){
get_surprise_for_feature_updates(x, updates_df)
}) %>%
bind_rows()
}
s_a1b1_s <- get_surprise_for_creature_udpates(s_a1b1) %>%
mutate(complexity = "simple",
params = "a1b1")
View(get_surprise_for_creature_updates)
?get_surprise_for_creature_updates
get_surprise_for_creature_updates
s_a1b1_s <- get_surprise_for_creature_updates(s_a1b1) %>%
mutate(complexity = "simple",
params = "a1b1")
c_a1b1_s <- get_surprise_for_creature_updates(c_a1b1) %>%
mutate(complexity = "complex",
params = "a1b1")
s_a1b5_s <- get_surprise_for_creature_updates(s_a1b5) %>%
mutate(complexity = "simple",
params = "a1b5")
c_a1b5_s <- get_surprise_for_creature_updates(c_a1b5)%>%
mutate(complexity = "complex",
params = "a1b5")
s_a5b1_s <- get_surprise_for_creature_updates(s_a5b1)%>%
mutate(complexity = "simple",
params = "a5b1")
c_a5b1_s <- get_surprise_for_creature_updates(c_a5b1)%>%
mutate(complexity = "complex",
params = "a5b1")
s_all <- bind_rows(s_a1b1_s, c_a1b1_s,
s_a1b5_s, c_a1b5_s,
s_a5b1_s, c_a5b1_s)
s_all %>%
group_by(update_number, complexity, params) %>%
summarise(predictability_creature = sum(predictability)) %>%
ggplot(aes(x = update_number,
y = predictability_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
s_all <- bind_rows(s_a1b1_s, c_a1b1_s,
s_a1b5_s, c_a1b5_s,
s_a5b1_s, c_a5b1_s)
s_all %>%
group_by(update_number, complexity, params) %>%
summarise(predictability_creature = sum(predictability)) %>%
ggplot(aes(x = update_number,
y = predictability_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
View(s_all)
s_all %>%
group_by(update_number, complexity, params) %>%
summarise(surprise_creature = sum(surprise)) %>%
ggplot(aes(x = update_number,
y = surprise_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
source('~/Desktop/projects/looking_time/adult_analysis/adult_modeling/scripts/get_entropy.R', echo=TRUE)
e_all %>%
group_by(update_number, complexity, params) %>%
summarise(predictability_creature = sum(predictability)) %>%
ggplot(aes(x = update_number,
y = predictability_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
get_entropy_for_creature_udpates
source('~/Desktop/projects/looking_time/adult_analysis/adult_modeling/scripts/get_entropy.R', echo=TRUE)
s_a1b1_e <- get_entropy_for_creature_udpates(s_a1b1) %>%
mutate(complexity = "simple",
params = "a1b1")
c_a1b1_e <- get_entropy_for_creature_udpates(c_a1b1) %>%
mutate(complexity = "complex",
params = "a1b1")
s_a1b5_e <- get_entropy_for_creature_udpates(s_a1b5) %>%
mutate(complexity = "simple",
params = "a1b5")
c_a1b5_e <- get_entropy_for_creature_udpates(c_a1b5)%>%
mutate(complexity = "complex",
params = "a1b5")
s_a5b1_e <- get_entropy_for_creature_udpates(s_a5b1)%>%
mutate(complexity = "simple",
params = "a5b1")
c_a5b1_e <- get_entropy_for_creature_udpates(c_a5b1)%>%
mutate(complexity = "complex",
params = "a5b1")
e_all <- bind_rows(s_a1b1_e, c_a1b1_e,
s_a1b5_e, c_a1b5_e,
s_a5b1_e, c_a5b1_e)
e_all %>%
group_by(update_number, complexity, params) %>%
summarise(predictability_creature = sum(predictability)) %>%
ggplot(aes(x = update_number,
y = predictability_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
e_all
View(e_all)
e_all %>%
group_by(update_number, complexity, params) %>%
summarise(predictability_creature = sum(e)) %>%
ggplot(aes(x = update_number,
y = predictability_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
e_all %>%
group_by(update_number, complexity, params) %>%
summarise(entropy_creature = sum(e)) %>%
ggplot(aes(x = update_number,
y = entropy_creature,
color = complexity)) +
geom_line() +
facet_wrap(~params)
obs_1
observation[[1]]
obs_1[[1:]]
obs_1[1:]
obs_1 %>% pull(paste0("V", 1))
library(tidyverse)
obs_1 %>% pull(paste0("V", 1))
