facet_wrap(~block_type)
block_dev_summary <- RT_data %>%
filter(trial_type == "deviant") %>%
mutate(
block_id =  paste(subject, block_number),
temp_dev_id = paste(trial_type, trial_number)) %>%
select(temp_dev_id, block_id)
RT_data %>%
mutate(block_id = paste(subject, block_number)) %>%
left_join(block_dev_summary, by = "block_id") %>%
separate(temp_dev_id, into = c("trial_type_temp", "deviant_pos")) %>%
select(-c(block_id, trial_type)) %>%
rowwise() %>%
mutate(dishabituation_position = case_when(
(trial_number == (as.numeric(deviant_pos)) - 1) ~ "before_deviant",
(trial_number == (as.numeric(deviant_pos)) + 1) ~ "after_deviant",
TRUE ~ "regular_deviant"
)) %>%
filter(dishabituation_position != "regular_deviant") %>%
ggplot(aes(x = dishabituation_position, y = log(rt))) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~trial_complexity)
block_dev_summary <- RT_data %>%
filter(trial_type == "deviant") %>%
mutate(
block_id =  paste(subject, block_number),
temp_dev_id = paste(trial_type, trial_number)) %>%
select(temp_dev_id, block_id)
dev_pos_df <- RT_data %>%
mutate(block_id = paste(subject, block_number)) %>%
left_join(block_dev_summary, by = "block_id") %>%
separate(temp_dev_id, into = c("trial_type_temp", "deviant_pos")) %>%
select(-c(block_id, trial_type)) %>%
rowwise() %>%
mutate(dishabituation_position = case_when(
(trial_number == (as.numeric(deviant_pos)) - 1) ~ "before_deviant",
(trial_number == (as.numeric(deviant_pos)) + 1) ~ "after_deviant",
TRUE ~ "regular_deviant"
)) %>%
filter(dishabituation_position != "regular_deviant")
dev_pos_df %>%
ggplot(aes(x = fct_rev(dishabituation_position), y = log(rt))) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~trial_complexity)
dev_pos_df %>%
ggplot(aes(x = fct_rev(dishabituation_position), y = log(rt), color = trial_complexity)) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~block_type)
dev_pos_df %>%
ggplot(aes(x = fct_rev(dishabituation_position), y = log(rt))) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~trial_complexity)
block_dev_summary <- RT_data %>%
filter(trial_type == "deviant") %>%
mutate(
block_id =  paste(subject, block_number),
temp_dev_id = paste(trial_type, trial_number, trial_complexity)) %>%
select(temp_dev_id, block_id)
dev_pos_df <- RT_data %>%
mutate(block_id = paste(subject, block_number)) %>%
left_join(block_dev_summary, by = "block_id") %>%
separate(temp_dev_id, into = c("trial_type_temp", "deviant_pos", "deviant_complexity")) %>%
select(-c(block_id, trial_type)) %>%
rowwise() %>%
mutate(dishabituation_position = case_when(
(trial_number == (as.numeric(deviant_pos)) - 1) ~ "before_deviant",
(trial_number == (as.numeric(deviant_pos)) + 1) ~ "after_deviant",
TRUE ~ "regular_deviant"
)) %>%
filter(dishabituation_position != "regular_deviant")
dev_pos_df %>%
ggplot(aes(x = fct_rev(dishabituation_position), y = log(rt))) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~deviant_complexity)
View(dev_pos_df)
block_dev_summary <- RT_data %>%
filter(trial_type == "deviant") %>%
mutate(
block_id =  paste(subject, block_number),
temp_dev_id = paste(trial_type, trial_number, trial_complexity)) %>%
select(temp_dev_id, block_id)
dev_pos_df <- RT_data %>%
mutate(block_id = paste(subject, block_number)) %>%
left_join(block_dev_summary, by = "block_id") %>%
separate(temp_dev_id, into = c("trial_type_temp", "deviant_pos", "deviant_complexity")) %>%
select(-c(block_id, trial_type)) %>%
rowwise() %>%
mutate(dishabituation_position = case_when(
(trial_number == (as.numeric(deviant_pos)) - 1) ~ "before_deviant",
(trial_number == (as.numeric(deviant_pos)) + 1) ~ "after_deviant",
TRUE ~ "regular_deviant"
)) %>%
filter(dishabituation_position != "regular_deviant" && deviant_pos != 8)
dev_pos_df %>%
ggplot(aes(x = fct_rev(dishabituation_position), y = log(rt))) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~deviant_complexity)
block_dev_summary <- RT_data %>%
filter(trial_type == "deviant") %>%
mutate(
block_id =  paste(subject, block_number),
temp_dev_id = paste(trial_type, trial_number, trial_complexity)) %>%
select(temp_dev_id, block_id)
dev_pos_df <- RT_data %>%
mutate(block_id = paste(subject, block_number)) %>%
left_join(block_dev_summary, by = "block_id") %>%
separate(temp_dev_id, into = c("trial_type_temp", "deviant_pos", "deviant_complexity")) %>%
select(-c(block_id, trial_type)) %>%
rowwise() %>%
mutate(dishabituation_position = case_when(
(trial_number == (as.numeric(deviant_pos)) - 1) ~ "before_deviant",
(trial_number == (as.numeric(deviant_pos)) + 1) ~ "after_deviant",
TRUE ~ "regular_deviant"
)) %>%
filter(dishabituation_position != "regular_deviant" && deviant_pos != 8)
dev_pos_df %>%
ggplot(aes(x = fct_rev(dishabituation_position), y = log(rt))) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~deviant_complexity)
dev_pos_df %>%
ggplot(aes(x = fct_rev(dishabituation_position), y = log(rt))) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~block_type)
pref_data
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = count())
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = n())
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = n()) %>%
mutate(
group_n = sum(n)
)
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = n()) %>%
group_by(block_number)
mutate(
group_n = sum(n)
)
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = n()) %>%
group_by(block_number) %>%
mutate(
group_n = sum(n)
)
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = n()) %>%
group_by(block_number) %>%
mutate(
group_n = sum(n),
percent = n/group_n
)
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = n()) %>%
group_by(block_number) %>%
mutate(
group_n = sum(n),
percent = n/group_n
) %>%
ggplot(aes(x = block_number, y = percent, color = stim_type_selected))
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = n()) %>%
group_by(block_number) %>%
mutate(
group_n = sum(n),
percent = n/group_n
) %>%
ggplot(aes(x = block_number, y = percent, color = stim_type_selected)) +
geom_point()
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = n()) %>%
group_by(block_number) %>%
mutate(
group_n = sum(n),
percent = n/group_n
) %>%
ggplot(aes(x = block_number, y = percent, color = stim_type_selected)) +
geom_point() +
geom_smooth(method = "lm")
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = n()) %>%
group_by(block_number) %>%
mutate(
group_n = sum(n),
percent = n/group_n
) %>%
ggplot(aes(x = block_number, y = percent, color = stim_type_selected)) +
geom_point() +
geom_smooth(method = "lm") +
xlim(1:20)
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = n()) %>%
group_by(block_number) %>%
mutate(
group_n = sum(n),
percent = n/group_n
) %>%
ggplot(aes(x = block_number, y = percent, color = stim_type_selected)) +
geom_point() +
geom_smooth(method = "lm") +
xlim(1,20)
pref_data %>%
group_by(block_number, stim_type_selected) %>%
summarise(n = n()) %>%
group_by(block_number) %>%
mutate(
group_n = sum(n),
percent = n/group_n
) %>%
ggplot(aes(x = block_number, y = percent, color = stim_type_selected)) +
geom_point() +
geom_smooth(method = "lm")
RT_data %>%
filter(block_number == 0) %>%
ggplot(aes(x=trial_number, y=log(rt), colour=item_type)) +
stat_summary(fun.data = "mean_cl_boot")
RT_data %>%
filter(block_number == 0) %>%
ggplot(aes(x = item_type, y = log(rt))) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~block_type)
RT_data %>%
filter(block_number == 0) %>%
ggplot(aes(x=trial_number, y=log(rt), colour=item_type)) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~block_type)
RT_data %>%
filter(block_number == 0) %>%
ggplot(aes(x = item_type, y = log(rt))) +
stat_summary(fun.data = "mean_cl_boot")
RT_data %>%
filter(block_number == 0) %>%
ggplot(aes(x=trial_number, y=log(rt), colour=item_type)) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~block_type)
RT_data %>%
filter(block_number == 0) %>%
ggplot(aes(x = item_type, y = log(rt))) +
stat_summary(fun.data = "mean_cl_boot") +
facet_wrap(~block_type)
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
library(lme4)
library(xtable)
library(lmerTest)
library(broom)
summary(model_full)
model <- lmer('log(rt) ~ trial_number*item_type*trial_complexity  + (1|subject)', data=RT_data, REML=FALSE)
summary(model)$coef
model <- lmer('log(rt) ~ trial_number*item_type*trial_complexity  + (1|subject)', data=RT_data, REML=FALSE)
summary(model)$coef %>% knitr::kable(digits = 2)
model_log <- lmer(log(rt) ~ log(trial_number) * item_type * trial_complexity +
(1 | subject),
data = RT_data)
summary(model_log)$coef %>% knitr::kable(digits = 2)
anova(model, model_log)
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_point()
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1) +
geom_smooth(se=FALSE)
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1) +
geom_smooth(se=FALSE, method = "lm")
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1) +
geom_smooth(se = FALSE, method = "lm") +
scale_y_log10()
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1) +
geom_smooth(se = FALSE, method = "lm") +
scale_y_log10() +
scale_x_log10()
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1) +
geom_smooth(se = FALSE, method = "lm") +
scale_y_log() +
scale_x_log()
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1, alpha = .03) +
stat_summary(geom = "line")
scale_y_log10() +
scale_x_log10()
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1, alpha = .03) +
stat_summary(geom = "line")+
scale_y_log10() +
scale_x_log10()
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1, alpha = .03) +
stat_summary(geom = "line") +
scale_y_log10()
# +
# scale_x_log10()
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1, alpha = .03) +
stat_summary(geom = "line") +
scale_y_log10() +
scale_x_log10()
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1, alpha = .03) +
stat_summary(geom = "line") +
geom_smooth(method = "lm") +
scale_y_log10() +
scale_x_log10()
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1, alpha = .03) +
stat_summary(geom = "line") +
geom_smooth(method = "lm", se = FALSE, col = "black") +
scale_y_log10() +
scale_x_log10()
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1, alpha = .03) +
stat_summary(geom = "line") +
geom_smooth(method = "lm", se = FALSE, lty = 2) +
scale_y_log10() +
scale_x_log10()
ggplot(filter(RT_data, item_type == "background"),
aes(x = trial_number, y = rt, col = trial_complexity)) +
geom_jitter(width = .1, alpha = .03) +
stat_summary(geom = "line") +
geom_smooth(method = "lm", se = FALSE, lty = 2) +
scale_y_log10()
#+
#  scale_x_log10()
summary(model_log)$coef %>% knitr::kable(digits = 2)
source('~/Desktop/projects/looking_time/adult_analysis/00_merged_and_deidentified.R', echo=TRUE)
library(here)
library(tidyverse)
library(stringr) # for parsing r string
library(jsonlite) # for parsing r string
d_path <- here("data/merged_data/merged_data.csv")
# d_path <- here("data/raw_data/testSS1612925903745.csv")
df.raw <- read_csv(d_path)
View(df.raw)
source('~/Desktop/projects/looking_time/adult_analysis/00_merged_and_deidentified.R', echo=TRUE)
View(RAW_DATA)
RAW_DATA
source('~/Desktop/projects/looking_time/adult_analysis/00_merged_and_deidentified.R', echo=TRUE)
RAW_DATA
library(here)
library(tidyverse)
library(stringr) # for parsing r string
library(jsonlite) # for parsing r string
d_path <- here("data/merged_data/merged_data.csv")
# d_path <- here("data/raw_data/testSS1612925903745.csv")
df.raw <- read_csv(d_path)
TEST_TRIAL <- c("pref_reveal", "trial")
# do we want to go w/ the data wrangling route or the jspsych route?
df.processed <- df.raw %>%
filter(stimulus_type == "trial") %>%
select(subject, rt,
block_number, block_type, stimulus_displayed,
block_deviant, block_background) %>%
group_by(subject, block_number) %>%
mutate(
trial_number = row_number()) %>%
mutate(
trial_type = case_when(
stimulus_displayed == block_deviant ~ "deviant",
TRUE ~ "background"
),
trial_complexity = case_when(
grepl("simple", stimulus_displayed) ~ "simple",
grepl("complex", stimulus_displayed) ~ "complex"
)
) %>%
mutate(trial_complexity = factor(trial_complexity, levels = c("simple", "complex"))) %>%
mutate(block_similarity = case_when(
grepl("_similar", block_type) ~ "similar",
grepl("_dissimilar", block_type) ~ "dissimilar"
)
) %>%
mutate(item_type = case_when(
trial_type == 'background' ~ trial_type,
trial_type == 'deviant' ~ paste(block_similarity, 'deviant')
)
) %>%
mutate(item_type = factor(
item_type,
levels = c("background",
"similar deviant",
"dissimilar deviant")
)
)  %>%
mutate(item_id =
str_match(stimulus_displayed, "spore_stims/\\s*(.*?)..\\s*.gif")[,2]
)  %>%
select(subject, block_number, block_type, trial_number, item_type, trial_type, trial_complexity, item_id, rt) %>%
transform(rt = as.numeric(rt)) %>%
mutate(half = case_when(
block_number <= max(block_number)/2 ~ 'first half' ,
block_number > max(block_number)/2 ~ 'second half',
)
)
write_csv(df.processed, here('data/processed_data/processed_RTdata.csv'))
# df.main
View(df.processed)
# complexity doesn't have trial type
df.similarity <- df.raw %>%
filter(trial_type == "survey-likert") %>%
mutate(
question_type = case_when(
stimulus_type == "similarity_question" ~ "similarity",
TRUE ~ "complexity"
)
) %>%
filter(question_type =="similarity") %>%
select(subject, question_type, rt, responses, stimulus_left, stimulus_right) %>%
# a dumb way to extrat the rating
separate(responses, into = c("question", "raw_answer"), sep = ":") %>%
mutate(
rating = as.numeric(str_extract(raw_answer, "[[:digit:]]+"))) %>%
select(subject, question_type, stimulus_left, stimulus_right, rating)
write_csv(df.similarity, here('data/processed_data/processed_similaritydata.csv'))
df.complexity <- df.raw %>%
filter(trial_type == "survey-likert") %>%
mutate(
question_type = case_when(
stimulus_type == "similarity_question" ~ "similarity",
TRUE ~ "complexity"
)
) %>%
filter(question_type =="complexity") %>%
select(subject, question_type, rt, responses, stimulus) %>%
# a dumb way to extrat the rating
separate(responses, into = c("question", "raw_answer"), sep = ":") %>%
mutate(
rating = as.numeric(str_extract(raw_answer, "[[:digit:]]+"))) %>%
select(subject, question_type, stimulus, rating)
write_csv(df.complexity, here('data/processed_data/processed_complexitydata.csv'))
df.demog <- df.raw  %>%
filter(grepl("demog", trial_type)) %>%
select(subject, trial_type, responses) %>%
toJSON() %>%
fromJSON() %>%
mutate(
demog_question = map(responses, ~ fromJSON(.) %>% as.data.frame())) %>%
unnest(demog_question)  %>%
group_by(subject) %>%
mutate_at(vars(-group_cols()), function(x) {x[!is.na(x)][1]}) %>%
distinct() %>%
select(-responses, -trial_type)
write_csv(df.demog, here('data/processed_data/processed_demogdata.csv'))
similarity_sbj <- df.similarity %>%
count(subject, rating) %>%
filter(n > 20 * 0.8) %>%  # twenty trials, 80% identical rating
pull(subject)
#similarity_sbj
complexity_sbj <- df.complexity %>%
count(subject, rating) %>%
filter(n > 20 * 0.8) %>%  # twenty trials, 80% identical rating
pull(subject)
exlude_participant <- unique(c(similarity_sbj, complexity_sbj))
df.rt_trimmed <- df.processed %>% filter(!(subject %in% exlude_participant))
df.pref_trimmed <- df.pref %>% filter(!(subject %in% exlude_participant))
df.complexity_trimmed <- df.complexity %>% filter(!(subject %in% exlude_participant))
df.similarity_trimmed <- df.similarity %>% filter(!(subject %in% exlude_participant))
df.demog_trimmmed <- df.demog %>% filter(!(subject %in% exlude_participant))
similarity_sbj <- df.similarity %>%
count(subject, rating) %>%
filter(n > 20 * 0.8) %>%  # twenty trials, 80% identical rating
pull(subject)
#similarity_sbj
complexity_sbj <- df.complexity %>%
count(subject, rating) %>%
filter(n > 20 * 0.8) %>%  # twenty trials, 80% identical rating
pull(subject)
exlude_participant <- unique(c(similarity_sbj, complexity_sbj))
df.rt_trimmed <- df.processed %>% filter(!(subject %in% exlude_participant))
#df.pref_trimmed <- df.pref %>% filter(!(subject %in% exlude_participant))
df.complexity_trimmed <- df.complexity %>% filter(!(subject %in% exlude_participant))
df.similarity_trimmed <- df.similarity %>% filter(!(subject %in% exlude_participant))
df.demog_trimmmed <- df.demog %>% filter(!(subject %in% exlude_participant))
rt_summary <- df.rt_trimmed %>%
summarise(
median = median(log(rt)),
mad = mad(log(rt)),
upper = median + 3 * mad,
lower = median - 3 * mad)
df.rt_trimmed <- df.rt_trimmed %>%
filter(!(log(rt) > rt_summary$upper | log(rt) < rt_summary$lower))
write_csv(df.rt_trimmed, here('data/processed_data/trimmed_RTdata.csv'))
#write_csv(df.pref_trimmed, here('data/processed_data/trimmed_prefdata.csv'))
write_csv(df.demog_trimmmed, here('data/processed_data/trimmed_demogdata.csv'))
write_csv(df.similarity_trimmed, here('data/processed_data/trimmed_similaritydata.csv'))
write_csv(df.complexity_trimmed, here('data/processed_data/trimmed_complexitydata.csv'))
