---
title: "prepping followup"
author: "anjie & gal"
date: "4/14/2022"
output: html_document
---

```{r}
library(tidyverse)
library(here)
library(jsonlite)
```

# get the subject id prolific id pariing 
```{r}
# has pairing 
rt_d <- read_csv(here("data/02_processed_data/processed_rt_task_data.csv"))
# has prolific id
p_id <- read_csv(here("data/01_merged_data/merged_data.csv")) %>% 
  filter(trial_type == "survey-text" & grepl("p_id", responses)) %>% 
  select(subject, responses) %>% 
  mutate(prolific_id = map(responses, ~ fromJSON(.) %>% as.data.frame()) %>% unlist()) %>% 
  filter(subject %in% unique(rt_d %>% pull(subject))) %>% 
  select(subject, prolific_id)
  
```


# figure out what stimuli participnats have seen

```{r}
# easiest case for math condition participants
background <- rt_d %>% 
 filter(task_question_type == "math") %>% 
  distinct(subject, trial_type, stimulus_displayed) %>% 
  ungroup() %>% 
  filter(trial_type == "background") %>% 
  group_by(subject, trial_type) %>% 
  summarise(background_stimuli = list(stimulus_displayed))

deviant <- rt_d %>% 
 filter(task_question_type == "math") %>% 
  distinct(subject, trial_type, stimulus_displayed) %>% 
  ungroup() %>% 
  filter(trial_type == "deviant") %>% 
  group_by(subject, trial_type) %>% 
  summarise(deviant_stimuli = list(stimulus_displayed))

json_df <- background %>% 
  left_join(deviant, by = "subject") %>% 
  select(subject, background_stimuli, deviant_stimuli)

math_json <- jsonlite::toJSON(json_df, pretty=T)
math_json
```


needs to figure out the novel stimulus presented at the memory/curiosity question 
```{r}
raw_d <- read_csv(here("data/01_merged_data/merged_data.csv"))

```

```{r}
raw_d %>% 
  select(question_stimuli)
```





